<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<title>隐私设置</title>
		<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<link rel="stylesheet" href="../mincss/mui.min.css">
		<link rel="stylesheet" href="../mincss/setting.min.css">
		<style type="text/css">
			.mui-scroll-wrapper {
				background: #f5f5f5;
			}
			
			.mui-bar {
				background: #fff;
			}
			
			.flex-item img {
				width: 80%;
			}
			
			.item1 {
				flex: 0 0 15% !important;
			}
			
			.item2 {
				flex: 0 0 57% !important;
			}
			
			.item3 {
				flex: 0 0 20% !important;
			}
			
			.item4 {
				flex: 0 0 8% !important;
			}
		</style>
	</head>

	<body>
		<header class="mui-bar mui-bar-nav" id="header">
			<a class="mui-icon mui-icon-back mui-action-back fl cfff hide" id="back"></a>
			<h1 class="mui-title cfff">消息</h1>
		</header>
		<div class="mui-content f13" id="muicontent">
			<div class="flex-box flex-row" onclick="Fan()">
				<div class="flex-item item1">
					<img src="../images/tip/01.png" class="fl" />
				</div>
				<div class="flex-item item2">
					<span class="c000 fl">新的粉丝</span>
				</div>
				<div class="flex-item item3 tr">
					<span class="mui-badge mui-badge-danger hide fr" id="fan-count">0</span>
				</div>
				<div class="flex-item item4 tr">
					<span class="mui-icon mui-icon-arrowright c999 f16"></span>
				</div>
			</div>
			<div class="flex-box flex-row" onclick="Zan()">
				<div class="flex-item item1">
					<img src="../images/tip/03.png" class="fl" />
				</div>
				<div class="flex-item item2">
					<span class="c000 fl">喜欢</span>
				</div>
				<div class="flex-item item3 tr">
					<span class="mui-badge mui-badge-danger hide fr" id="zan-count">0</span>
				</div>
				<div class="flex-item item4 tr">
					<span class="mui-icon mui-icon-arrowright c999 f16"></span>
				</div>
			</div>
			<div class="flex-box flex-row" onclick="Comment()">
				<div class="flex-item item1">
					<img src="../images/tip/02.png" class="fl" />
				</div>
				<div class="flex-item item2">
					<span class="c000 fl">评论</span>
				</div>
				<div class="flex-item item3 tr">
					<span class="mui-badge mui-badge-danger hide fr" id="comment-count">0</span>
				</div>
				<div class="flex-item item4 tr">
					<span class="mui-icon mui-icon-arrowright c999 f16"></span>
				</div>
			</div>
			<div class="flex-box flex-row" onclick="Pay()">
				<div class="flex-item item1">
					<img src="../images/tip/04.png" class="fl" />
				</div>
				<div class="flex-item item2">
					<span class="c000 fl">赞赏</span>
				</div>
				<div class="flex-item item3 tr">
					<span class="mui-badge mui-badge-danger hide fr" id="pay-count">0</span>
				</div>
				<div class="flex-item item4 tr">
					<span class="mui-icon mui-icon-arrowright c999 f16"></span>
				</div>
			</div>
			<ul class="mui-table-view">
				<li class="mui-table-view-cell hide" onclick="Client()" id="client">
					<span class="fl">设备信息</span>
					<span class="mui-icon mui-icon-arrowright fr c999 f18"></span>
				</li>
				<li class="mui-table-view-cell hide" onclick="Link()" id="article_link">
					<span class="fl">文章链接</span>
					<span class="mui-icon mui-icon-arrowright fr c999 f18"></span>
				</li>
				<li class="mui-table-view-cell hide" onclick="Music()" id="music">
					<span class="fl">音乐搜索</span>
					<span class="mui-icon mui-icon-arrowright fr c999 f18"></span>
				</li>
				<li class="mui-table-view-cell hide" onclick="ArticleDetail()" id="adv">
					<span class="fl">文章详细</span>
					<span class="mui-icon mui-icon-arrowright fr c999 f18"></span>
				</li>
				<li class="mui-table-view-cell hide" onclick="EditComment()" id="editcomment">
					<span class="fl">评论</span>
					<span class="mui-icon mui-icon-arrowright fr c999 f18"></span>
				</li>
				<li class="mui-table-view-cell hide" onclick="Index()" id="index">
					<span class="fl">编辑文字</span>
					<span class="mui-icon mui-icon-arrowright fr c999 f18"></span>
				</li>
				<li class="mui-table-view-cell hide" onclick="Banner()" id="banner">
					<span class="fl">Banner文章</span>
					<span class="mui-icon mui-icon-arrowright fr c999 f18"></span>
				</li>
				<li class="mui-table-view-cell hide" onclick="Back()" id="backstage">
					<span class="fl">后台</span>
					<span class="mui-icon mui-icon-arrowright fr c999 f18"></span>
				</li>
				<li class="mui-table-view-cell hide" onclick="Line()" id="line">
					<span class="fl">效果</span>
					<span class="mui-icon mui-icon-arrowright fr c999 f18"></span>
				</li>
			</ul>
		</div>
	</body>

</html>
<script src="../minjs/mui.min.js"></script>
<script src="../minjs/base.min.js"></script>
<script type="text/javascript">
	var isLoading = false;
	var PageName = "tipsetting.html";
	var userinfo = base.GetUserInfo();
	var mask = base.CreateMask(false, function() {
		base.CloseWaiting();
	});

	mui.init({
		beforeback: function() {
			if(base.CheckWaiting()) {
				return false;
			}
		}
	});

	mui.ready(function() {
		base.Immersed();

		if(userinfo.UserRole == 1) {
			base.RemoveClass(["#backstage"], "hide");
		}
		if(userinfo.UserRole == 2) {
			base.RemoveClass(["#client", "#article_link", "#music", "#editcomment", "#adv", "#index", "#banner", "#backstage", "#line"], "hide");
		}
	});

	mui.plusReady(function() {
		var self = plus.webview.currentWebview();
		var source = self.Source || "";
		var push = self.Push || "";
		if(!base.IsNullOrEmpty(source)) {
			base.Get("back").classList.remove("hide");
		}
		if(!base.IsNullOrEmpty(push)) {
			var pushInfo = JSON.parse(push);
			var moneycount = 0;
			mui.each(pushInfo, function(i, item) {
				if(item.PushType == PushType.Fan) {
					base.Get("fan-count").innerHTML = item.PushCount;
					base.Get("fan-count").classList.remove("hide");
				}
				if(item.PushType == PushType.Comment) {
					base.Get("comment-count").innerHTML = item.PushCount;
					base.Get("comment-count").classList.remove("hide");
				}
				if(item.PushType == PushType.Money || item.PushType == PushType.Red) {
					moneycount += parseInt(item.PushCount);
				}
			})
			if(moneycount > 0) {
				base.Get("pay-count").innerHTML = moneycount;
				base.Get("pay-count").classList.remove("hide");
			}
		}
	});

	function PushClear(pushtype) {
		if(pushtype == PushType.Fan) {
			base.Get("fan-count").innerHTML = 0;
			base.Get("fan-count").classList.add("hide");
		}
		if(pushtype == PushType.Comment) {
			base.Get("comment-count").innerHTML = 0;
			base.Get("comment-count").classList.add("hide");
		}
		if(pushtype == PushType.Money) {
			base.Get("pay-count").innerHTML = 0;
			base.Get("pay-count").classList.add("hide");
		}
		if(pushtype == PushType.Red) {
			base.Get("pay-count").innerHTML = 0;
			base.Get("pay-count").classList.add("hide");
		}
	}

	//粉丝
	function Fan() {
		var param = {
			UserNumber: userinfo.Number
		}
		base.ShowTemplate("fan", "fan.html", "我的粉丝", JSON.stringify(param));
	}

	//喜欢
	function Zan() {
		var param = {
			ShowMe: 1
		}
		base.ShowTemplate("zan", "zan.html", "我的喜欢", JSON.stringify(param));
	}

	//评论
	function Comment() {
		base.OpenWindow("comment", "comment.html", {});
	}

	//打赏
	function Pay() {
		base.OpenWindow("mypayinfo", "mypayinfo.html", {});
	}

	//更新
	function Update() {
		base.OpenWindow("test", "test.html", {});
	}

	//设备信息
	function Client() {
		alert(plus.push.getClientInfo().clientid);
	}

	//设备信息
	function Push() {
		HttpGet(base.RootUrl + "Api/Push/Single", {}, function(data) {
			data = JSON.parse(data);
			if(data != null) {
				mui.toast(data.message);
			}
		});
	}

	//文章链接
	function Link() {
		base.OpenWindow("article_link", "article_link.html", {});
	}

	//音乐
	function Music() {
		base.OpenWindow("music", "music.html", {});
	}

	//广告
	function ImageViewer() {
		base.OpenWindow("adv", "adv.html", {});
		//base.OpenWindow("imageviewer", "imageviewer.html", {});
	}

	//通知
	function Guide() {
		base.OpenWindow("test", "../test/main.html", {});
	}

	//下拉
	function Pull() {
		//base.OpenWindow("pull", "../test/webview_pullhead.html", {});
		base.OpenWindow("pull", "template.html", {});
	}

	//评论编辑
	function EditComment() {
		base.OpenWindow("editcomment", "editcomment.html", {});
	}

	//自定义装扮
	function Index() {
		base.OpenWindow("showy", "showy.html", {
			ArticleID: 0
		});
	}

	//自定义装扮
	function Banner() {
		base.OpenWindow("bannerdetail", "bannerdetail.html", {
			ArticleID: 0
		});
	}

	//效果
	function Line() {
		base.OpenWindow("line", "line.html", {});
	}

	//后台
	function Back() {
		base.OpenWindow("back", "back.html", {});
	}

	//文章详细
	function ArticleDetail() {
		base.OpenWindow("articledetail_new", "articledetail_new.html", {
			ArticleID: 551,
			Source: "",
			ArticlePower: 3,
			NickName: ""
		}, null, "none");
	}
</script>