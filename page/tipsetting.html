<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<title>隐私设置</title>
		<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<link rel="stylesheet" href="../mincss/mui.min.css">
		<style type="text/css">
			.mui-scroll-wrapper {
				background: #f5f5f5;
			}
			
			.mui-bar {
				background: #fff;
			}
			
			.mui-table-view-cell img {
				width: 80%;
			}
			
			.item1 {
				flex: 0 0 15%;
			}
			
			.item2 {
				flex: 0 0 57%;
			}
			
			.item3 {
				flex: 0 0 20%;
			}
			
			.item4 {
				flex: 0 0 8%;
			}
		</style>
	</head>

	<body>
		<header class="mui-bar mui-bar-nav" id="header">
			<a class="mui-icon mui-icon-back mui-action-back fl cfff hide" id="back"></a>
			<h1 class="mui-title cfff">消息</h1>
		</header>
		<div class="mui-content">
			<ul class="mui-table-view f13 mt15">
				<li class="mui-table-view-cell" onclick="Fan()">
					<div class="flex-box flex-row">
						<div class="flex-item item1">
							<img src="../images/tip/01.png" class="fl" />
						</div>
						<div class="flex-item item2">
							<span class="c000 fl">新的粉丝</span>
						</div>
						<div class="flex-item item3 tr">
							<span class="mui-badge mui-badge-danger hide fr" id="fan-count">0</span>
						</div>
						<div class="flex-item item4 tr">
							<span class="mui-icon mui-icon-arrowright c999 f16"></span>
						</div>
					</div>
				</li>
				<li class="mui-table-view-cell" onclick="Zan()">
					<div class="flex-box flex-row">
						<div class="flex-item item1">
							<img src="../images/tip/03.png" class="fl" />
						</div>
						<div class="flex-item item2">
							<span class="c000 fl">喜欢</span>
						</div>
						<div class="flex-item item3 tr">
							<span class="mui-badge mui-badge-danger hide fr" id="zan-count">0</span>
						</div>
						<div class="flex-item item4 tr">
							<span class="mui-icon mui-icon-arrowright c999 f16"></span>
						</div>
					</div>
				</li>
				<li class="mui-table-view-cell" onclick="Comment()">
					<div class="flex-box flex-row">
						<div class="flex-item item1">
							<img src="../images/tip/02.png" class="fl" />
						</div>
						<div class="flex-item item2">
							<span class="c000 fl">评论</span>
						</div>
						<div class="flex-item item3 tr">
							<span class="mui-badge mui-badge-danger hide fr" id="comment-count">0</span>
						</div>
						<div class="flex-item item4 tr">
							<span class="mui-icon mui-icon-arrowright c999 f16"></span>
						</div>
					</div>
				</li>
				<li class="mui-table-view-cell" onclick="Pay()">
					<div class="flex-box flex-row">
						<div class="flex-item item1">
							<img src="../images/tip/04.png" class="fl" />
						</div>
						<div class="flex-item item2">
							<span class="c000 fl">赞赏</span>
						</div>
						<div class="flex-item item3 tr">
							<span class="mui-badge mui-badge-danger hide fr" id="pay-count">0</span>
						</div>
						<div class="flex-item item4 tr">
							<span class="mui-icon mui-icon-arrowright c999 f16"></span>
						</div>
					</div>
				</li>
				<li class="mui-table-view-cell hide" onclick="Client()" id="client">
					<span class="fl mt10">设备信息</span>
					<span class="mui-icon mui-icon-arrowright fr c999 f18 mt10"></span>
				</li>
				<li class="mui-table-view-cell hide" onclick="Link()" id="article_link">
					<span class="fl mt10">文章链接</span>
					<span class="mui-icon mui-icon-arrowright fr c999 f18 mt10"></span>
				</li>
				<li class="mui-table-view-cell hide" onclick="Music()" id="music">
					<span class="fl mt10">音乐搜索</span>
					<span class="mui-icon mui-icon-arrowright fr c999 f18 mt10"></span>
				</li>
				<li class="mui-table-view-cell hide" onclick="ImageViewer()" id="adv">
					<span class="fl mt10">图片预览</span>
					<span class="mui-icon mui-icon-arrowright fr c999 f18 mt10"></span>
				</li>
				<li class="mui-table-view-cell hide" onclick="EditComment()" id="editcomment">
					<span class="fl mt10">评论</span>
					<span class="mui-icon mui-icon-arrowright fr c999 f18 mt10"></span>
				</li>
			</ul>
		</div>
	</body>

</html>
<script src="../minjs/mui.min.js"></script>
<script src="../minjs/base.min.js"></script>
<script type="text/javascript">
	var isLoading = false;
	var PageName = "tipsetting.html";
	var userinfo = base.GetUserInfo();
	var mask = base.CreateMask(false, function() {
		base.CloseWaiting();
	});

	mui.init();

	mui.ready(function() {
		base.Immersed();

		if(userinfo.UserRole == 2) {
			base.RemoveClass(["#client", "#article_link", "#music", "#editcomment", "#adv"], "hide");
		}
	});

	mui.plusReady(function() {

		var self = plus.webview.currentWebview();
		var source = self.Source || "";
		var push = self.Push || "";
		if(!base.IsNullOrEmpty(source)) {
			base.Get("back").classList.remove("hide");
		}
		if(!base.IsNullOrEmpty(push)) {
			var pushInfo = JSON.parse(push);
			mui.each(pushInfo, function(i, item) {
				if(item.PushType == PushType.Fan) {
					base.Get("fan-count").innerHTML = item.PushCount;
					base.Get("fan-count").classList.remove("hide");
				}
				if(item.PushType == PushType.Comment) {
					base.Get("comment-count").innerHTML = item.PushCount;
					base.Get("comment-count").classList.remove("hide");
				}
				if(item.PushType == PushType.Money) {
					base.Get("pay-count").innerHTML = item.PushCount;
					base.Get("pay-count").classList.remove("hide");
				}
			})
		}
	});

	function PushClear(pushtype) {
		if(pushtype == PushType.Fan) {
			base.Get("fan-count").innerHTML = 0;
			base.Get("fan-count").classList.add("hide");
		}
		if(pushtype == PushType.Comment) {
			base.Get("comment-count").innerHTML = 0;
			base.Get("comment-count").classList.add("hide");
		}
		if(pushtype == PushType.Money) {
			base.Get("pay-count").innerHTML = 0;
			base.Get("pay-count").classList.add("hide");
		}
	}

	//粉丝
	function Fan() {
		base.OpenWindow("fan", "fan.html", {});
	}

	//喜欢
	function Zan() {
		base.OpenWindow("zan", "zan.html", {
			ShowMe: 1
		});
	}

	//评论
	function Comment() {
		base.OpenWindow("comment", "comment.html", {});
	}

	//打赏
	function Pay() {
		base.OpenWindow("pay", "pay.html", {});
	}

	//更新
	function Update() {
		base.OpenWindow("test", "test.html", {});
	}

	//设备信息
	function Client() {
		alert(plus.push.getClientInfo().clientid);
	}

	//设备信息
	function Push() {
		HttpGet(base.RootUrl + "Api/Push/Single", {}, function(data) {
			data = JSON.parse(data);
			if(data != null) {
				mui.toast(data.message);
			}
		});
	}

	//文章链接
	function Link() {
		base.OpenWindow("article_link", "article_link.html", {});
	}

	//音乐
	function Music() {
		base.OpenWindow("musicsearch", "musicsearch.html", {});
	}

	//广告
	function ImageViewer() {
		base.OpenWindow("imageviewer", "imageviewer.html", {});
	}

	//通知
	function Guide() {
		base.OpenWindow("test", "../test/main.html", {});
	}

	//下拉
	function Pull() {
		//base.OpenWindow("pull", "../test/webview_pullhead.html", {});
		base.OpenWindow("pull", "template.html", {});
	}

	//评论编辑
	function EditComment() {
		base.OpenWindow("editcomment", "editcomment.html", {});
	}
</script>