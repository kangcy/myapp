<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<title></title>
		<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<link rel="stylesheet" href="../css/mui.min.css">
		<link rel="stylesheet" href="../css/img.preview.css">
		<link rel="stylesheet" href="../css/animate.css">
		<link rel="stylesheet" href="../css/loading.min.css">
		<style type="text/css">
			#adduser {
				width: 10%;
				height: 100%;
				display: inline-block;
				background: url(../images/base/adduser.png) center center no-repeat;
				background-size: 20px;
				position: absolute;
				right: 10px;
				top: 0px;
			}
		</style>
	</head>

	<body>
		<header class="mui-bar mui-bar-nav" style="background:#fff;">
			<div class="fr tc" id="adduser" onclick="AddUser()"></div>
			<div class="mui-title c333">关注</div>
		</header>
		<div class="loading" id="loader">
			<div class="card">
				<span class="circles-loader"></span>
			</div>
		</div>
		<!--操作-->
		<div id="actionwrapper"></div>
		<div class="mui-content">
			<div class="mui-scroll-wrapper" style="top:45px;bottom:0px;">
				<div class="mui-scroll" id="pullrefresh">
					<div id="scroll-view">
					</div>
				</div>
			</div>
		</div>
	</body>

</html>
<script src="../js/mui.min.js"></script>
<script src="../js/base.js"></script>
<script src="../js/mui.pullToRefresh.js"></script>
<script src="../js/mui.pullToRefresh.material.js"></script>
<script src="../js/mui.zoom.js"></script>
<script src="../js/mui.previewimage.js"></script>
<script src="../js/PullRefresh.js"></script>
<script src="../js/article.js"></script>
<script src="../js/addarticle2.js"></script>
<script type="text/javascript">
	var currpage = 1;
	var totalpage = 2;
	var pagesize = base.PageSize;
	var userinfo = base.GetUserInfo();
	var isLoading = false;
	var PageName = "index.html";
	var FullScreen = false;

	mui.init({
		gestureConfig: {
			doubletap: true
		}
	});

	mui.ready(function() {

		mui('#actionwrapper').load("../part/action.html", function(response) {
			base.Get("action").addEventListener('hidden', function(event) {
				ShowMask(false, false, PageName);
			});
		});

		base.InitScroll();

		base.ScrollTop();

		base.ShowUser("#pullrefresh");
	});

	mui.plusReady(function() {

		base.ShowArticle("#pullrefresh", "List", userinfo.Number);

		base.ArticleAction("#pullrefresh", userinfo);

		mui(base.Get("pullrefresh")).pullToRefresh({
			down: {
				callback: function() {
					var self = this;
					pulldownRefresh(self);
				}
			},
			up: {
				auto: true,
				callback: function() {
					var self = this;
					pullupRefresh(self);
				}
			}
		});

		mui.previewImage({
			callback1: function(img) {
				ShowMask(true, false, PageName);
			},
			callback2: function(img) {
				mui.later(function() {
					ShowMask(false, false, PageName);
				}, 350);
			}
		});
	});

	/**
	 * 加载数据
	 */
	function Load(callback) {
		var table = base.Get('scroll-view');
		var data = {
			ID: userinfo.ID,
			page: currpage,
			rows: pagesize,
			UserNumber: userinfo.Number
		};
		HttpGet(base.RootUrl + "Api/Fan/Article", data, function(data) {
			data = JSON.parse(data);
			base.ShowLoading(false);
			if(data != null) {
				if(data.result) {
					data = data.message;
					totalpage = data.totalpage;
					var length = data.records;
					if(length > 0) {
						for(var i = 0, len = data.list.length; i < len; i++) {
							var div = base.AppendArticle(userinfo.Number, data.list[i], false, false, false);
							table.appendChild(div);
						}
					}
				}
			}
			callback();
		});
	}

	//添加用户
	function AddUser() {
		base.OpenWindow("addfan", "addfan.html", {});
	}
</script>