<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<title></title>
		<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<link rel="stylesheet" href="../css/mui.min.css">
		<link rel="stylesheet" href="../css/province.css">
	</head>

	<body>
		<header class="mui-bar mui-bar-nav">
			<a id="back" class="mui-icon mui-icon-back fl c333"></a>
			<div class="mui-title c333">选择城市</div>
		</header>
		<div class="mui-content">
			<div class="mui-loader tc" id="loader">
				<div class="line-scale-pulse-out">
					<div></div>
					<div></div>
					<div></div>
					<div></div>
					<div></div>
				</div>
			</div>
			<div id='list' class="mui-indexed-list">
				<div class="mui-indexed-list-search mui-input-row">
					<div class="mui-table-view-cell f12"><span id="currPosition">正在定位...</span><span class="fr blue" id="reFixPosition"><span class="mui-icon mui-icon-reload f15 bold"></span><span class="ml5">重新定位</span></span>
					</div>
				</div>
				<div class="mui-indexed-list-bar f12">
					<a>A</a>
					<a>B</a>
					<a>C</a>
					<a>F</a>
					<a>G</a>
					<a>H</a>
					<a>J</a>
					<a>L</a>
					<a>N</a>
					<a>Q</a>
					<a>R</a>
					<a>S</a>
					<a>T</a>
					<a>X</a>
					<a>Y</a>
					<a>Z</a>
				</div>
				<div class="mui-indexed-list-alert"></div>
				<div class="mui-indexed-list-inner">
					<div class="mui-indexed-list-empty-alert">没有数据</div>
					<ul class="mui-table-view f12">
						<li data-group="A" class="mui-table-view-divider mui-indexed-list-group">A</li>
						<li data-value="安徽省" class="mui-table-view-cell mui-indexed-list-item">安徽省</li>
						<li data-value="澳门" class="mui-table-view-cell mui-indexed-list-item">澳门</li>
						<li data-group="B" class="mui-table-view-divider mui-indexed-list-group">B</li>
						<li data-value="北京市" class="mui-table-view-cell mui-indexed-list-item">北京市</li>
						<li data-group="C" class="mui-table-view-divider mui-indexed-list-group">C</li>
						<li data-value="重庆市" class="mui-table-view-cell mui-indexed-list-item">重庆市</li>
						<li data-group="F" class="mui-table-view-divider mui-indexed-list-group">F</li>
						<li data-value="福建省" class="mui-table-view-cell mui-indexed-list-item">福建省</li>
						<li data-group="G" class="mui-table-view-divider mui-indexed-list-group">G</li>
						<li data-value="广东省" class="mui-table-view-cell mui-indexed-list-item">广东省</li>
						<li data-value="广西省" class="mui-table-view-cell mui-indexed-list-item">广西省</li>
						<li data-value="贵州省" class="mui-table-view-cell mui-indexed-list-item">贵州省</li>
						<li data-value="甘肃省" class="mui-table-view-cell mui-indexed-list-item">甘肃省</li>
						<li data-group="H" class="mui-table-view-divider mui-indexed-list-group">H</li>
						<li data-value="河北省" class="mui-table-view-cell mui-indexed-list-item">河北省</li>
						<li data-value="黑龙江省" class="mui-table-view-cell mui-indexed-list-item">黑龙江省</li>
						<li data-value="河南省" class="mui-table-view-cell mui-indexed-list-item">河南省</li>
						<li data-value="湖北省" class="mui-table-view-cell mui-indexed-list-item">湖北省</li>
						<li data-value="湖南省" class="mui-table-view-cell mui-indexed-list-item">湖南省</li>
						<li data-value="海南省" class="mui-table-view-cell mui-indexed-list-item">海南省</li>
						<li data-group="J" class="mui-table-view-divider mui-indexed-list-group">J</li>
						<li data-value="吉林省" class="mui-table-view-cell mui-indexed-list-item">吉林省</li>
						<li data-value="江苏省" class="mui-table-view-cell mui-indexed-list-item">江苏省</li>
						<li data-value="江西省" class="mui-table-view-cell mui-indexed-list-item">江西省</li>
						<li data-group="L" class="mui-table-view-divider mui-indexed-list-group">L</li>
						<li data-value="辽宁省" class="mui-table-view-cell mui-indexed-list-item">辽宁省</li>
						<li data-group="N" class="mui-table-view-divider mui-indexed-list-group">N</li>
						<li data-value="内蒙古自治区" class="mui-table-view-cell mui-indexed-list-item">内蒙古自治区</li>
						<li data-value="宁夏回族自治区" class="mui-table-view-cell mui-indexed-list-item">宁夏回族自治区</li>
						<li data-group="Q" class="mui-table-view-divider mui-indexed-list-group">Q</li>
						<li data-value="青海省" class="mui-table-view-cell mui-indexed-list-item">青海省</li>
						<li data-group="S" class="mui-table-view-divider mui-indexed-list-group">S</li>
						<li data-value="山西省" class="mui-table-view-cell mui-indexed-list-item">山西省</li>
						<li data-value="上海市" class="mui-table-view-cell mui-indexed-list-item">上海市</li>
						<li data-value="山东省" class="mui-table-view-cell mui-indexed-list-item">山东省</li>
						<li data-value="四川省" class="mui-table-view-cell mui-indexed-list-item">四川省</li>
						<li data-value="陕西省" class="mui-table-view-cell mui-indexed-list-item">陕西省</li>
						<li data-group="T" class="mui-table-view-divider mui-indexed-list-group">T</li>
						<li data-value="天津市" class="mui-table-view-cell mui-indexed-list-item">天津市</li>
						<li data-value="台湾省" class="mui-table-view-cell mui-indexed-list-item">台湾省</li>
						<li data-group="W" class="mui-table-view-divider mui-indexed-list-group">W</li>
						<li data-value="西藏自治区" class="mui-table-view-cell mui-indexed-list-item">西藏自治区</li>
						<li data-value="新疆维吾尔自治区" class="mui-table-view-cell mui-indexed-list-item">新疆维吾尔自治区</li>
						<li data-value="香港" class="mui-table-view-cell mui-indexed-list-item">香港</li>
						<li data-group="Y" class="mui-table-view-divider mui-indexed-list-group">Y</li>
						<li data-value="云南省" class="mui-table-view-cell mui-indexed-list-item">云南省</li>
						<li data-group="Z" class="mui-table-view-divider mui-indexed-list-group">Z</li>
						<li data-value="浙江省" class="mui-table-view-cell mui-indexed-list-item">浙江省</li>
					</ul>
				</div>
			</div>
		</div>
	</body>

</html>
<script src="../js/mui.min.js"></script>
<script src="../js/base.js"></script>
<script src="../js/mui.indexedlist.js"></script>
<script type="text/javascript">
	var province = "";
	var city = "";
	mui.init();

	mui.ready(function() {
		var list = document.getElementById('list');
		list.style.height = (window.innerHeight - 45) + 'px';
		window.indexedList = new mui.IndexedList(list);

		mui("#list").on('tap', '.mui-indexed-list-item', function(event) {
			var province = this.getAttribute("data-value");
			base.OpenWindow("city", "city.html", {
				Province: province
			});
		});
	});

	mui.plusReady(function() {
		FixPosition();

		document.getElementById('reFixPosition').addEventListener('tap', function(e) {
			FixPosition();
		});

		document.getElementById('currPosition').addEventListener('tap', function(e) {
			var mysettingPage = plus.webview.getWebviewById("mysetting");
			if(mysettingPage) {
				mysettingPage.evalJS("UpdateAddress('" + province + "','" + city + "')");
			}
		});
	});

	function FixPosition() {
		//系统定位
		document.getElementById("currPosition").innerHTML = "正在定位...";
		plus.geolocation.getCurrentPosition(function(p) {
			//{"coordsType":"gcj02","address":{"country":"中国","province":"江苏省","city":"南京市","district":"雨花台区","street":"软件大道","poiName":"丰盛·商汇(软件大道)","cityCode":"025"},"addresses":"江苏省南京市雨花台区软件大道靠近丰盛·商汇(软件大道)","coords":{"latitude":31.97603,"longitude":118.761916,"accuracy":25,"altitude":0,"heading":null,"speed":0,"altitudeAccuracy":0},"timestamp":1479280218323}
			console.log(JSON.stringify(p));
			province = p.address.province;
			city = p.address.city;
			setTimeout(function() {
				document.getElementById("currPosition").innerHTML = city;
			}, 200)

		}, function(e) {
			mui.toast("未授权");
		});
	}
</script>