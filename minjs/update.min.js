var UpdateUrl="";function CheckUpdate(a){plus.runtime.getProperty(plus.runtime.appid,function(c){var b=c.version;if(mui.os.ios){client="ios"}else{client="android"}HttpGet(base.RootUrl+"System/CheckUpdate",{version:b,client:client},function(e){base.CloseWaiting();if(e==null){return}if(e.result){UpdateUrl=e.url;base.Get("persent").innerHTML="0%";base.Get("myprogress_desc").innerHTML="";var f=e.remark.split("|");var g=[];for(var d=0;d<f.length;d++){g.push('<p class="full tl mb10">'+f[d]+"</p>")}base.Get("myprogress_desc").innerHTML=g.join("");base.RemoveClass(["#myprogressbg","#myprogress"],"hide");base.AddClass(["#myprogress"],"bounceInUp");a(1)}else{mask.close()}})})}function Download(){base.Get("myprogress_btn").classList.add("hide");base.Get("myprogress_progress").classList.remove("hide");var b=base.Get("persent");var a=base.Get("proDownFile");var d=document.getElementById("proDownFile").clientWidth;base.Get("persent").style.width=document.getElementById("myprogress_progress").clientWidth*0.16+"px";var e=plus.downloader.createDownload(UpdateUrl,{},function(i,f){if(f==200){clearInterval(c);b.innerHTML="100%";plus.nativeUI.toast("正在准备安装环境，请稍后！");mui.later(function(){Next()},2000);var h=i.filename;plus.runtime.install(h);var g={};localStorage.setItem("$userinfo",JSON.stringify(g))}else{mui.toast("更新失败");Next()}});e.start();var c=setInterval(function(){var f=e.totalSize;if(f>0){a.setAttribute("max",f);var g=e.downloadedSize;a.setAttribute("value",g);b.style.left=d*g/f+"px";b.innerHTML=parseInt(100*g/f)+"%"}},100)}function Next(){base.AddClass(["#myprogress","#myprogressbg"],"hide");base.Get("proDownFile").setAttribute("value",0);base.Get("proDownFile").setAttribute("max",0);base.Get("persent").style.left="0px";base.Get("persent").innerHTML="0%"};