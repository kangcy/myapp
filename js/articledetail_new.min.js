function ChangeMusic(){base.AddClass(["#music0","#music1"],"hide"),MusicID="music"+(0==CurrTemplate?0:1),base.IsNullOrEmpty(MusicUrl)||(1==Article.AutoMusic&&document.addEventListener("touchstart",startsound),base.Get("music"+(0==CurrTemplate?0:1)).classList.remove("hide"))}function ChangeBg(){if(0==CurrTemplate?(base.Get("x-avatar").classList.add("hide"),base.Get("x-article").classList.remove("tc"),base.Get("x-article").classList.add("tl"),base.Get("nickname0").classList.remove("hide"),base.Get("desc").classList.remove("temp"),base.Get("x-content").classList.remove("mt10")):(base.Get("x-avatar").classList.remove("hide"),base.Get("x-article").classList.remove("tl"),base.Get("x-article").classList.add("tc"),base.Get("nickname1").classList.remove("hide"),base.Get("desc").classList.add("temp"),base.Get("x-content").classList.add("mt10")),ChangeMusic(),0==CurrTemplate)$wrapper.style.backgroundColor="",$wrapper1.style.background="",$cover.style.backgroundColor="",$wrapper2.style.background="";else if(CurrTemplate>1){if(base.Get("x-avatar").style.paddingTop=CurrTemplateJson.MarginTop+"rem",$cover.style.backgroundColor=CurrTemplateJson.Transparency,0==CurrTemplateJson.CoverFixed)base.IsNullOrEmpty(CurrTemplateJson.BackgroundImage)||($wrapper1.style.backgroundImage="url("+CurrTemplateJson.BackgroundImage+")",base.IsNullOrEmpty(CurrTemplateJson.BackgroundRepeat)||($wrapper1.style.backgroundRepeat=CurrTemplateJson.BackgroundRepeat),base.IsNullOrEmpty(CurrTemplateJson.BackgroundSize)||($wrapper1.style.backgroundSize=CurrTemplateJson.BackgroundSize)),base.IsNullOrEmpty(CurrTemplateJson.Background)||($wrapper.style.background=CurrTemplateJson.Background,CurrTemplateJson.Background.startWith("#")||CurrTemplateJson.Background.startWith("rgba")||($wrapper.style.background=base.BrowserName()+CurrTemplateJson.Background));else if(1==CurrTemplateJson.CoverFixed)base.IsNullOrEmpty(CurrTemplateJson.BackgroundImage)||($wrapper2.style.backgroundImage="url("+CurrTemplateJson.BackgroundImage+")",base.IsNullOrEmpty(CurrTemplateJson.BackgroundRepeat)||($wrapper2.style.backgroundRepeat=CurrTemplateJson.BackgroundRepeat),base.IsNullOrEmpty(CurrTemplateJson.BackgroundSize)||($wrapper2.style.backgroundSize=CurrTemplateJson.BackgroundSize)),base.IsNullOrEmpty(CurrTemplateJson.Background)||(CurrTemplateJson.Background.startWith("#")||CurrTemplateJson.Background.startWith("rgba")?$wrapper2.style.backgroundColor=CurrTemplateJson.Background:($wrapper2.style.background=CurrTemplateJson.Background,$wrapper2.style.background=base.BrowserName()+CurrTemplateJson.Background)),$wrapper2.classList.remove("hide");else if(2==CurrTemplateJson.CoverFixed){if(!base.IsNullOrEmpty(CurrTemplateJson.TopImage)){for(var e=[],r=0;r<CurrTemplateJson.TopImage.length;r++){var t=CurrTemplateJson.TopImage[r];e.push('<img src="'+t.Url+'" class="'+t.Align+'" style="width:'+t.Width+'" />')}$top.innerHTML=e.join(""),$top.classList.remove("hide")}base.IsNullOrEmpty(CurrTemplateJson.BottomImage)||($bottom.setAttribute("src",CurrTemplateJson.BottomImage),$bottom.classList.remove("hide")),base.IsNullOrEmpty(CurrTemplateJson.BackgroundImage)||($wrapper2.style.backgroundImage="url("+CurrTemplateJson.BackgroundImage+")",base.IsNullOrEmpty(CurrTemplateJson.BackgroundRepeat)||($wrapper2.style.backgroundRepeat=CurrTemplateJson.BackgroundRepeat),base.IsNullOrEmpty(CurrTemplateJson.BackgroundSize)||($wrapper2.style.backgroundSize=CurrTemplateJson.BackgroundSize),$wrapper2.classList.remove("hide")),base.IsNullOrEmpty(CurrTemplateJson.Background)||(CurrTemplateJson.Background.startWith("#")||CurrTemplateJson.Background.startWith("rgba")?$wrapper2.style.backgroundColor=CurrTemplateJson.Background:($wrapper2.style.background=CurrTemplateJson.Background,$wrapper2.style.background=base.BrowserName()+CurrTemplateJson.Background),$wrapper2.classList.remove("hide"))}}else if($wrapper.style.backgroundColor="transparent",$wrapper1.style.background="",null==CurrBackground)$wrapper2.style.background="",$wrapper2.className="";else{$cover.style.backgroundColor="RGBA(255, 255, 255, "+(100-CurrBackground.Transparency)/100+")";var a=CurrBackground.Url;switch(a=0==CurrBackground.High?base.ShowThumb(a,1):base.ShowThumb(a,0),$wrapper2.className="",CurrBackground.Full){case 0:$wrapper2.style.background="url("+a+") no-repeat top center",$wrapper2.style.backgroundSize="100% 15.5rem";break;case 1:$wrapper2.style.background="url("+a+") center center no-repeat",$wrapper2.style.backgroundSize="cover"}}}function UpdateComment(){Article.Comments+=1,base.Get("footer_comment").innerHTML=Article.Comments}function UpdateDetail(){Load(function(){mui.later(function(){plus.webview.close("articlepreview","none"),plus.webview.close("addarticle","none"),plus.webview.close("sharesetting"),plus.webview.show("articledetail","fade-in")},500)})}function Delete(){mask.close();mui.confirm("确定要删除这篇文章吗？删除后将无法在浏览器中浏览","",["确定","取消"],function(e){e.index<0||0==e.index&&HttpGet(base.RootUrl+"Article/Delete",{ID:userinfo.ID,ArticleID:ArticleID},function(e){setTimeout(function(){null!=e&&e.result&&(userinfo.Articles-=1,localStorage.setItem("$userinfo",JSON.stringify(userinfo)),base.RefreshUser(),base.GetView("article").evalJS("Refresh()"),self.close())},500)})})}function Copy(){if(!isLoading){isLoading=!0,mui("#topPopover").popover("hide"),mask.show(),base.ShowWaiting("正在复制");var e=base.GetCurrentPosition();HttpGet(base.RootUrl+"Article/Copy",{ID:userinfo.ID,ArticleID:ArticleID,Province:e.Province,City:e.City,District:e.District,Street:e.Street,DetailName:e.DetailName,CityCode:e.CityCode,Latitude:e.Latitude,Longitude:e.Longitude},function(e){mui.later(function(){mask.close(),mui.toast(e.result?"复制成功,前往我的动态查看":e.message),isLoading=!1,e.result&&(base.OpenWindow("article","article.html",{CreateUserNumber:userinfo.Number,ArticleTypeName:"我的动态",Source:"My"}),userinfo.Articles+=1,localStorage.setItem("$userinfo",JSON.stringify(userinfo)),base.RefreshUser())},500)})}}function Edit(){stopsound(),mui("#topPopover").popover("hide"),mask.show(),base.ShowWaiting("正在同步文章内容"),base.OpenWindow("addarticle","addarticle.html",{ArticleID:ArticleID,ArticleNumber:Article.Number,Source:Source}),mui.later(function(){mask.close()},2e3)}function Power(){stopsound(),mask.close(),base.OpenWindow("sharesetting","sharesetting.html",{ArticleID:ArticleID,ArticleNumber:Article.Number,ArticlePower:Article.ArticlePower,ArticlePowerPwd:Article.ArticlePowerPwd,ArticleType:Article.TypeID,ArticleTypeName:Article.TypeName})}function Keep(){isLoading||(isLoading=!0,HttpGet(base.RootUrl+"Api/Keep/Edit",{ID:userinfo.ID,ArticleID:ArticleID},function(e){e=JSON.parse(e),base.CheckLogin(userinfo,e.code),null!=e?(e.result&&(base.Get("iskeep").classList.remove("hide"),base.Get("isnotkeep").classList.add("hide"),userinfo.Keeps+=1,localStorage.setItem("$userinfo",JSON.stringify(userinfo)),base.RefreshUser()),mui.toast(e.result?"收藏成功,在[收藏]中可以找到Ta哦!":e.message)):mui.toast("失败"),isLoading=!1}))}function OutKeep(){mui.confirm("确定要取消收藏吗？","",["确定","取消"],function(e){e.index<0||0==e.index&&HttpGet(base.RootUrl+"Api/Keep/Delete",{ID:userinfo.ID,ArticleNumber:Article.Number},function(e){e=JSON.parse(e),base.CheckLogin(userinfo,e.code),null!=e?(e.result&&(base.Get("iskeep").classList.add("hide"),base.Get("isnotkeep").classList.remove("hide"),userinfo.Keeps-=1,userinfo.Keeps<0&&(userinfo.Keeps=0),localStorage.setItem("$userinfo",JSON.stringify(userinfo)),base.RefreshUser()),mui.toast(e.result?"":e.message)):mui.toast("失败"),isLoading=!1})})}function UpdatePower(e,r,t,a){Article.ArticlePower=e,Article.ArticlePowerPwd=r,Article.TypeID=t,Article.TypeName=a}function UpdateAction(){base.AddClass(["#popover_delete","#popover_edit","#popover_power"],"hide"),plus.webview.close("sharesetting")}