function initEditor(e){var t=document.getElementById("editor");base.IsNullOrEmpty(e)?t.contentWindow.document.write('<link rel="stylesheet" href="../css/mui.min.css"><body style="'+bodyStyle+'"><div class="edit f12 tl" contenteditable="true"></div><script src="../js/base.min.js"><\/script></body>'):t.contentWindow.document.write('<link rel="stylesheet" href="../css/mui.min.css"><body style="'+bodyStyle+'">'+e+'<script src="../js/base.min.js"><\/script></body>'),t.contentWindow.document.close(),objEditor=document.getElementById("editor"),w=objEditor.contentWindow,isIE?t.contentWindow.document.documentElement.attachEvent("onpaste",function(e){return pasteClipboardData(t.id,e)}):(edDoc=objEditor.contentWindow.document,objEditorBody=objEditor.contentWindow.document.body.firstChild,t.contentWindow.document.addEventListener("paste",function(e){return pasteClipboardData(t.id,e)},!1))}function getSel(e){return e.getSelection?e.getSelection():e.document.selection}function setRange(e,t){e.removeAllRanges(),e.addRange(t)}function filterPasteWord(e){return e=e.replace(/\r\n|\n|\r/gi,""),e=e.replace(/^\s*(&nbsp;)+/gi,""),e=e.replace(/(&nbsp;|<br[^>]*>)+\s*$/gi,""),e=e.replace(/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|xml|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,""),e=e.replace(/<p [^>]*class="?MsoHeading"?[^>]*>(.*?)<\/p>/gi,"<p><strong>$1</strong></p>"),e=e.replace(/(lang)\s*=\s*([\'\"]?)[\w-]+\2/gi,""),e=e.replace(/(<[a-z][^>]*)\sstyle="([^"]*)"/gi,function(e,t,n){for(var o=[],i=0,a=n.trim().replace(/&quot;/gi,"'").split(";"),i=0;i<a.length;i++){v=a[i];var r,s,d=v.split(":");if(2==d.length){switch(r=d[0].toLowerCase(),s=d[1].toLowerCase(),r){case"mso-padding-alt":case"mso-padding-top-alt":case"mso-padding-right-alt":case"mso-padding-bottom-alt":case"mso-padding-left-alt":case"mso-margin-alt":case"mso-margin-top-alt":case"mso-margin-right-alt":case"mso-margin-bottom-alt":case"mso-margin-left-alt":case"mso-table-layout-alt":case"mso-height":case"mso-width":case"mso-vertical-align-alt":o[i++]=r.replace(/^mso-|-alt$/g,"")+":"+ensureUnits(s);continue;case"horiz-align":o[i++]="text-align:"+s;continue;case"vert-align":o[i++]="vertical-align:"+s;continue;case"font-color":case"mso-foreground":o[i++]="color:"+s;continue;case"mso-background":case"mso-highlight":o[i++]="background:"+s;continue;case"mso-default-height":o[i++]="min-height:"+ensureUnits(s);continue;case"mso-default-width":o[i++]="min-width:"+ensureUnits(s);continue;case"mso-padding-between-alt":o[i++]="border-collapse:separate;border-spacing:"+ensureUnits(s);continue;case"text-line-through":"single"!=s&&"double"!=s||(o[i++]="text-decoration:line-through");continue;case"mso-zero-height":"yes"==s&&(o[i++]="display:none");continue}if(/^(mso|column|font-emph|lang|layout|line-break|list-image|nav|panose|punct|row|ruby|sep|size|src|tab-|table-border|text-(?:align|decor|indent|trans)|top-bar|version|vnd|word-break)/.test(r))continue;o[i++]=r+":"+d[1]}}return i>0?t+' style="'+o.join(";")+'"':t})}function filterPasteText(e){return e=e.replace(/<\/?[^>]*>/g,""),e.value=e.replace(/[ | ]*\n/g,"\n"),e=e.replace(/\n[\s| | ]*\r/g,"\n")}function isWordDocument(e){return new RegExp(/(class=\"?Mso|style=\"[^\"]*\bmso\-|w:WordDocument)/gi).test(e)}function filterPasteData(e){return isWordDocument(e)&&(e=filterPasteWord(e)),filterPasteText(e)}function block(e){e.preventDefault()}function pasteClipboardData(e,t){if(isIE){var n=objEditor.contentWindow.document.selection.createRange(),o=document.getElementById("ifmTemp");return o?o.contentWindow.document.body.firstChild.innerHTML="":((o=document.createElement("IFRAME")).id="ifmTemp",o.style.width="1px",o.style.height="1px",o.style.position="absolute",o.style.border="none",o.style.left="-10000px",o.src="iframeblankpage.html",document.body.appendChild(o),o.contentWindow.document.designMode="On",o.contentWindow.document.open(),o.contentWindow.document.write('<link rel="stylesheet" href="../css/mui.min.css"><body style="'+bodyStyle+'"><div tabindex="-1" class="edit f12 tl"></div><script src="../js/base.min.js"><\/script></body>'),o.contentWindow.document.close()),originText=objEditorBody.innerText,o.contentWindow.focus(),o.contentWindow.document.execCommand("Paste",!1,null),objEditor.contentWindow.focus(),newData=o.contentWindow.document.body.firstChild.innerHTML,newData=filterPasteData(newData),o.contentWindow.document.body.firstChild.innerHTML=newData,n.pasteHTML(newData),t&&(t.returnValue=!1,t.preventDefault&&t.preventDefault()),!1}enableKeyDown=!1;var i=edDoc.createElement("DIV");i.id="htmleditor_tempdiv",i.innerHTML="\ufeff",i.style.left="-10000px",i.style.height="1px",i.style.width="1px",i.style.position="absolute",i.style.overflow="hidden",objEditorBody.appendChild(i),edDoc.addEventListener("mousedown",block,!1),edDoc.addEventListener("keydown",block,!1),enableKeyDown=!1,or=getSel(w).getRangeAt(0);var a=i.firstChild;return rng=edDoc.createRange(),rng.setStart(a,0),rng.setEnd(a,1),setRange(getSel(w),rng),"\ufeff"===(originText=edDoc.body.textContent)&&(originText=""),window.setTimeout(function(){if("\ufeff"===i.innerHTML)return newData="",void objEditorBody.removeChild(i);newData=i.innerHTML,or&&setRange(getSel(w),or),newData=filterPasteData(newData),i.innerHTML=newData,objEditorBody.childNodes.length<=1?objEditorBody.innerHTML=newData:(edDoc.execCommand("insertHtml",!1,newData),edDoc.body.firstChild.removeChild(i))},0),enableKeyDown=!0,edDoc.removeEventListener("mousedown",block,!1),edDoc.removeEventListener("keydown",block,!1),!0}function ShowParentNode(){var e=[],t=objEditor.contentWindow.document.selection&&objEditor.contentWindow.document.selection.createRange?objEditor.contentWindow.document.selection.createRange().parentElement():objEditor.contentWindow.getSelection().focusNode.parentNode;do{e.push(t.tagName)}while((t=t.parentNode)&&t!==objEditor.contentWindow.document.documentElement);return e.reverse()}var or,divTemp,originText,newData,objEditor,objEditorBody,edDoc,w,isIE=-1!=navigator.appName.indexOf("Microsoft"),bodyStyle="margin:0;min-height:100px;padding:10px;word-break:break-all;";